var ROOT_URL="http://internal.axihub.ca/folding";function sortJsonByKey(a){return function(c,b){return c[a]>b[a]?1:c[a]<b[a]?-1:0}}function ordinalSuffixOf(a){var c=a%10,b=a%100;return 1==c&&11!=b?a+"st":2==c&&12!=b?a+"nd":3==c&&13!=b?a+"rd":a+"th"}
function populateDropdown(){$("#user_dropdown").empty();fetch(ROOT_URL+"/users").then(function(a){return a.json()}).then(function(a){dropdown_div=document.getElementById("user_dropdown");$.each(a,function(a,b){userButton=document.createElement("button");userButton.setAttribute("class","dropdown-item");userButton.setAttribute("type","button");userButton.setAttribute("onclick","getUserHistoricStats("+b.id+",'"+b.displayName+"')");userButton.innerHTML=b.displayName;dropdown_div.append(userButton)})})}
function getUserHistoricStats(a,c){$("#loader").show();$("#historic_stats").hide();var b=new Date,f=b.getFullYear(),d=b.getMonth()+1,e=b.toLocaleString("default",{month:"long"});fetch(ROOT_URL+"/historic/users/"+a+"/"+f+"/"+d).then(function(a){return a.json()}).then(function(a){console.log(a);user_dropdown_root;dropDownTitle=document.getElementById("user_dropdown_root");dropDownTitle.innerHTML=c;for(historicDiv=document.getElementById("historic_stats");historicDiv.firstChild;)historicDiv.removeChild(historicDiv.lastChild);
userTitle=document.createElement("h1");userTitle.setAttribute("class","navbar-brand");userTitle.innerHTML=c+" ("+e+" "+f+")";historicDiv.append(userTitle);historicTable=document.createElement("table");historicTable.setAttribute("id","historic_table");historicTable.setAttribute("class","table table-striped table-hover");tableHead=document.createElement("thead");tableHeaderRow=document.createElement("tr");["Date","Points","Units"].forEach(function(a,b){tableHeader=document.createElement("th");tableHeader.setAttribute("onclick",
"sortTable("+b+", 'historic_table')");tableHeader.setAttribute("scope","col");tableHeader.innerHTML=a;tableHeaderRow.append(tableHeader)});tableHead.append(tableHeaderRow);historicTable.append(tableHead);tableBody=document.createElement("tbody");a.forEach(function(a,b){console.log(a);tableRow=document.createElement("tr");dateCell=document.createElement("td");dateCell.innerHTML=ordinalSuffixOf(a.date.day);tableRow.append(dateCell);pointsCell=document.createElement("td");pointsCell.setAttribute("data-toggle",
"tooltip");pointsCell.setAttribute("data-placement","top");pointsCell.setAttribute("title","Unmultiplied: "+a.points.toLocaleString());pointsCell.innerHTML=a.multipliedPoints.toLocaleString();tableRow.append(pointsCell);unitsCell=document.createElement("td");unitsCell.innerHTML=a.units.toLocaleString();tableRow.append(unitsCell);tableBody.append(tableRow)});historicTable.append(tableBody);historicDiv.append(historicTable);$('[data-toggle\x3d"tooltip"]').tooltip();$("#loader").hide();$("#historic_stats").show()})}
$(document).ready(function(){populateDropdown();updateTime()});
function sortTable(a,c){var b,f,d,e,g,h,k,l=0;c=document.getElementById(c);f=!0;for(k="asc";f;){f=!1;b=c.rows;for(d=1;d<b.length-1;d++)if(h=!1,e=b[d].getElementsByTagName("TD")[a],g=b[d+1].getElementsByTagName("TD")[a],"asc"==k)if(isNaN(e.innerHTML)||isNaN(g.innerHTML)){if(e.innerHTML.toLowerCase()>g.innerHTML.toLowerCase()){h=!0;break}}else{if(parseInt(e.innerHTML)>parseInt(g.innerHTML)){h=!0;break}}else if("desc"==k)if(isNaN(e.innerHTML)||isNaN(g.innerHTML)){if(e.innerHTML.toLowerCase()<g.innerHTML.toLowerCase()){h=
!0;break}}else if(parseInt(e.innerHTML)<parseInt(g.innerHTML)){h=!0;break}h?(b[d].parentNode.insertBefore(b[d+1],b[d]),f=!0,l++):0==l&&"asc"==k&&(k="desc",f=!0)}}function updateTime(){var a=new Date,a=3600-(a.getUTCMinutes()-15)%60*60-a.getUTCSeconds();minutes=Math.floor(a/60)%60;seconds=a%60;$("#min-part").text(minutes);$("#sec-part").text(String(seconds).padStart(2,"0"));setTimeout(updateTime,1E3-(new Date).getUTCMilliseconds())};
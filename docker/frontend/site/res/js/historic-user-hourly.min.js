var ROOT_URL="http://internal.axihub.ca/folding";
function populateUserDropdown(){for(var a=document.getElementById("user_dropdown");a.firstChild;)a.removeChild(a.lastChild);fetch(ROOT_URL+"/users").then(function(a){return a.json()}).then(function(a){userDropdownDiv=document.getElementById("user_dropdown");a.forEach(function(a,c){userButton=document.createElement("button");userButton.setAttribute("class","dropdown-item");userButton.setAttribute("type","button");userButton.setAttribute("onclick","getUserHistoricStats("+a.id+",'"+a.displayName+"')");
userButton.innerHTML=a.displayName;userDropdownDiv.append(userButton)})})}
function getUserHistoricStats(a,c){show("loader");hide("historic_stats");var b=new Date,g=b.getFullYear(),d=b.getMonth()+1,f=b.toLocaleString("default",{month:"long"}),e=b.getDate();fetch(ROOT_URL+"/historic/users/"+a+"/"+g+"/"+d+"/"+e).then(function(a){return a.json()}).then(function(a){dropDownTitle=document.getElementById("user_dropdown_root");dropDownTitle.innerHTML=c;for(historicDiv=document.getElementById("historic_stats");historicDiv.firstChild;)historicDiv.removeChild(historicDiv.lastChild);userTitle=
document.createElement("h1");userTitle.setAttribute("class","navbar-brand");userTitle.innerHTML=c+" ("+ordinalSuffixOf(e)+" "+f+" "+g+")";historicDiv.append(userTitle);historicTable=document.createElement("table");historicTable.setAttribute("id","historic_table");historicTable.setAttribute("class","table table-dark table-striped table-hover");tableHead=document.createElement("thead");tableHeaderRow=document.createElement("tr");["Hour","Points","Units"].forEach(function(a,b){tableHeader=document.createElement("th");
tableHeader.setAttribute("onclick","sortTable("+b+", 'historic_table')");tableHeader.setAttribute("scope","col");tableHeader.innerHTML=a;tableHeaderRow.append(tableHeader)});tableHead.append(tableHeaderRow);historicTable.append(tableHead);tableBody=document.createElement("tbody");a.forEach(function(a,b){tableRow=document.createElement("tr");dateCell=document.createElement("td");dateCell.innerHTML=leftPad(a.dateTime.time.hour,2,"0")+":00";tableRow.append(dateCell);pointsCell=document.createElement("td");
pointsCell.setAttribute("data-bs-toggle","tooltip");pointsCell.setAttribute("data-placement","top");pointsCell.setAttribute("title","Unmultiplied: "+a.points.toLocaleString());pointsCell.innerHTML=a.multipliedPoints.toLocaleString();new bootstrap.Tooltip(pointsCell);tableRow.append(pointsCell);unitsCell=document.createElement("td");unitsCell.innerHTML=a.units.toLocaleString();tableRow.append(unitsCell);tableBody.append(tableRow)});historicTable.append(tableBody);historicDiv.append(historicTable);
hide("loader");show("historic_stats")})}document.addEventListener("DOMContentLoaded",function(a){populateUserDropdown();updateTimer()});function show(a){document.getElementById(a).style.display="block"}function hide(a){document.getElementById(a).style.display="none"}function ordinalSuffixOf(a){var c=a%10,b=a%100;return 1==c&&11!=b?a+"st":2==c&&12!=b?a+"nd":3==c&&13!=b?a+"rd":a+"th"}function leftPad(a,c,b){return(String(b).repeat(c)+String(a)).slice(String(a).length)}
function sortTable(a,c){var b,g,d,f,e,h,k,l=0;c=document.getElementById(c);g=!0;for(k="asc";g;){g=!1;b=c.rows;for(d=1;d<b.length-1;d++)if(h=!1,f=b[d].getElementsByTagName("TD")[a],e=b[d+1].getElementsByTagName("TD")[a],"asc"==k)if(isNaN(f.innerHTML)||isNaN(e.innerHTML)){if(f.innerHTML.toLowerCase()>e.innerHTML.toLowerCase()){h=!0;break}}else{if(parseInt(f.innerHTML)>parseInt(e.innerHTML)){h=!0;break}}else if("desc"==k)if(isNaN(f.innerHTML)||isNaN(e.innerHTML)){if(f.innerHTML.toLowerCase()<e.innerHTML.toLowerCase()){h=
!0;break}}else if(parseInt(f.innerHTML)<parseInt(e.innerHTML)){h=!0;break}h?(b[d].parentNode.insertBefore(b[d+1],b[d]),g=!0,l++):0==l&&"asc"==k&&(k="desc",g=!0)}}function updateTimer(){var a=new Date,a=3600-(a.getUTCMinutes()-55)%60*60-a.getUTCSeconds();minutes=Math.floor(a/60)%60;seconds=a%60;document.getElementById("min-part").innerHTML=minutes;document.getElementById("sec-part").innerHTML=String(seconds).padStart(2,"0");setTimeout(updateTimer,1E3-(new Date).getUTCMilliseconds())};
var ROOT_URL="http://internal.axihub.ca/folding";function toggleMainButtonStyle(a,b){a=document.getElementById(a);b.contains("collapsed")?(a.classList.add("btn-primary"),a.classList.remove("btn-success")):(a.classList.add("btn-success"),a.classList.remove("btn-primary"))}
function toggleTeam(a,b){a=document.getElementById("team_"+a+"_button");b.contains("collapsed")?(a.classList.add("btn-primary"),a.classList.remove("btn-success")):(a.classList.add("btn-success"),a.classList.remove("btn-primary"))}
function loadOverallStats(){fetch(ROOT_URL+"/tc_stats").then(function(a){return a.json()}).then(function(a){overallDiv=document.getElementById("overall_div");overallTitle=document.createElement("h2");overallTitle.setAttribute("class","navbar-brand");overallTitle.innerHTML="Overall Stats";overallDiv.append(overallTitle);overallTable=document.createElement("table");overallTable.setAttribute("id","overall");overallTable.setAttribute("class","table table-dark table-striped table-hover");overallTableHead=
document.createElement("thead");overallTableHeaderRow=document.createElement("tr");["Total Points","Total Units"].forEach(function(a,c){overallTableHeader=document.createElement("th");overallTableHeader.setAttribute("onclick","sortTable("+c+", 'overall')");overallTableHeader.setAttribute("scope","col");overallTableHeader.innerHTML=a;overallTableHeaderRow.append(overallTableHeader)});overallTableHead.append(overallTableHeaderRow);overallTable.append(overallTableHead);overallTableBody=document.createElement("tbody");
overallTableBodyRow=document.createElement("tr");["totalMultipliedPoints","totalUnits"].forEach(function(b,c){overallTableBodyCell=document.createElement("td");"totalMultipliedPoints"===b&&(overallTableBodyCell.setAttribute("data-bs-toggle","tooltip"),overallTableBodyCell.setAttribute("data-placement","top"),overallTableBodyCell.setAttribute("title","Unmultiplied: "+a.totalPoints.toLocaleString()),new bootstrap.Tooltip(overallTableBodyCell));overallTableBodyCell.innerHTML=a[b].toLocaleString();overallTableBodyRow.append(overallTableBodyCell)});
overallTableBody.append(overallTableBodyRow);overallTable.append(overallTableBody);overallDiv.append(overallTable)})}
function loadTeamLeaderboard(){fetch(ROOT_URL+"/tc_stats/leaderboard").then(function(a){return a.json()}).then(function(a){var b="rank teamName teamMultipliedPoints teamUnits diffToLeader diffToNext".split(" ");leaderboardDiv=document.getElementById("leaderboard_div");leaderboardTitle=document.createElement("h2");leaderboardTitle.setAttribute("class","navbar-brand");leaderboardTitle.innerHTML="Team Leaderboard";leaderboardTable=document.createElement("table");leaderboardTable.setAttribute("id","leaderboard");
leaderboardTable.setAttribute("class","table table-dark table-striped table-hover");leaderboardTableHead=document.createElement("thead");leaderboardTableHeaderRow=document.createElement("tr");"Rank;Team;Points;Units;Points To Leader;Points To Next".split(";").forEach(function(a,b){leaderboardTableHeader=document.createElement("th");leaderboardTableHeader.setAttribute("onclick","sortTable("+b+", 'leaderboard')");leaderboardTableHeader.setAttribute("scope","col");leaderboardTableHeader.innerHTML=a;
leaderboardTableHeaderRow.append(leaderboardTableHeader)});leaderboardTableHead.append(leaderboardTableHeaderRow);leaderboardTable.append(leaderboardTableHead);leaderboardTableBody=document.createElement("tbody");a.forEach(function(a,e){leaderboardTableBodyRow=document.createElement("tr");b.forEach(function(b){leaderboardCell=document.createElement("td");"teamMultipliedPoints"===b&&(leaderboardCell.setAttribute("data-bs-toggle","tooltip"),leaderboardCell.setAttribute("data-placement","top"),leaderboardCell.setAttribute("title",
"Unmultiplied: "+a.teamPoints.toLocaleString()),new bootstrap.Tooltip(leaderboardCell));leaderboardCell.innerHTML=a[b].toLocaleString();leaderboardTableBodyRow.append(leaderboardCell)});leaderboardTableBody.append(leaderboardTableBodyRow)});leaderboardTable.append(leaderboardTableBody);leaderboardDiv.append(leaderboardTitle);leaderboardDiv.append(leaderboardTable);hide("loader")})}
function loadCategoryLeaderboard(){fetch(ROOT_URL+"/tc_stats/category").then(function(a){return a.json()}).then(function(a){categoryDiv=document.getElementById("category_div");var b="Rank;User;Points;Units;Points to Leader;Points to Next".split(";"),c="rank displayName multipliedPoints units diffToLeader diffToNext".split(" ");categoryLeaderboardTitle=document.createElement("h2");categoryLeaderboardTitle.setAttribute("class","navbar-brand");categoryLeaderboardTitle.innerHTML="Category Leaderboard";
categoryDiv.append(categoryLeaderboardTitle);Object.keys(a).forEach(function(e){categoryTitle=document.createElement("h2");categoryTitle.setAttribute("class","navbar-brand");categoryTitle.innerHTML=e;categoryDiv.append(categoryTitle);tableId="category_"+e.replace(/\s+/g,"_").toLowerCase();categoryTable=document.createElement("table");categoryTable.setAttribute("id",tableId);categoryTable.setAttribute("class","table table-dark table-striped table-hover");categoryTableHead=document.createElement("thead");
categoryTableHeaderRow=document.createElement("tr");b.forEach(function(a,b){categoryTableHeader=document.createElement("th");categoryTableHeader.setAttribute("onclick","sortTable("+b+", '"+tableId+"')");categoryTableHeader.setAttribute("scope","col");categoryTableHeader.innerHTML=a;categoryTableHeaderRow.append(categoryTableHeader)});categoryTableHead.append(categoryTableHeaderRow);categoryTable.append(categoryTableHead);categoryTableBody=document.createElement("tbody");users=a[e];users.forEach(function(a){categoryTableBodyRow=
document.createElement("tr");c.forEach(function(b){categoryCell=document.createElement("td");"multipliedPoints"===b&&(categoryCell.setAttribute("data-bs-toggle","tooltip"),categoryCell.setAttribute("data-placement","top"),categoryCell.setAttribute("title","Unmultiplied: "+a.points.toLocaleString()),new bootstrap.Tooltip(categoryCell));categoryCell.innerHTML=a[b].toLocaleString();categoryTableBodyRow.append(categoryCell)});categoryTableBody.append(categoryTableBodyRow)});categoryTable.append(categoryTableBody);
categoryDiv.append(categoryTable);categoryDiv.append(document.createElement("br"))})})}
function loadTeamStats(){fetch(ROOT_URL+"/tc_stats").then(function(a){return a.json()}).then(function(a){var b="Rank User Category Hardware Points Units".split(" "),c="rankInTeam displayName category hardware multipliedPoints units".split(" ");a=a.teams;a.sort(sortJsonByKey("rank"));a.forEach(function(a,f){var d=f+1,e=a.captainName;teamDiv=document.createElement("div");teamDiv.setAttribute("id","team_"+d+"_div");metadataDiv=document.createElement("div");metadataDiv.setAttribute("id","team_"+d+"_metadata");
teamTitle=document.createElement("h2");teamTitle.setAttribute("class","navbar-brand");teamTitle.innerHTML="Rank #"+a.rank+": ";teamTitle.innerHTML="forumLink"in a?teamTitle.innerHTML+("\x3ca href\x3d'"+a.forumLink+"' target\x3d'_blank'\x3e"+a.teamName+"\x3c/a\x3e"):teamTitle.innerHTML+a.teamName;metadataDiv.append(teamTitle);teamStats=document.createElement("h5");teamStats.setAttribute("id","team_"+d+"_stats");teamStats.setAttribute("data-bs-toggle","tooltip");teamStats.setAttribute("data-placement",
"top");teamStats.setAttribute("title","Unmultiplied: "+a.teamPoints.toLocaleString());teamStats.innerHTML=a.teamMultipliedPoints.toLocaleString()+" points | "+a.teamUnits.toLocaleString()+" units";new bootstrap.Tooltip(teamStats);metadataDiv.append(teamStats);teamButton=document.createElement("button");teamButton.setAttribute("id","team_"+d+"_button");teamButton.setAttribute("class","btn ui-btn btn-primary");teamButton.setAttribute("href","#team_"+d+"_subdiv");teamButton.setAttribute("onclick","toggleTeam("+
d+", this.classList)");teamButton.setAttribute("data-bs-toggle","collapse");teamButton.setAttribute("role","button");teamButton.innerHTML="Show/Hide";metadataDiv.append(teamButton);teamDiv.append(metadataDiv);subDiv=document.createElement("div");subDiv.setAttribute("id","team_"+d+"_subdiv");subDiv.setAttribute("class","collapse");teamTable=document.createElement("table");teamTable.setAttribute("id","team_"+d);teamTable.setAttribute("class","table table-dark table-striped table-hover");teamTableHead=
document.createElement("thead");teamTableHeaderRow=document.createElement("tr");b.forEach(function(a,b){teamTableHeaderCell=document.createElement("th");teamTableHeaderCell.setAttribute("onclick","sortTable("+b+", 'team_"+d+"')");teamTableHeaderCell.setAttribute("scope","col");teamTableHeaderCell.innerHTML=a;teamTableHeaderRow.append(teamTableHeaderCell)});teamTableHead.append(teamTableHeaderRow);teamTable.append(teamTableHead);teamTableBody=document.createElement("tbody");activeUsers=a.activeUsers;
activeUsers.sort(sortJsonByKey("rankInTeam"));activeUsers.forEach(function(a,b){teamTableBodyRow=document.createElement("tr");c.forEach(function(b,c){teamTableUserCell=document.createElement("td");"multipliedPoints"===b?(teamTableUserCell.setAttribute("data-bs-toggle","tooltip"),teamTableUserCell.setAttribute("data-placement","left"),teamTableUserCell.setAttribute("title","Unmultiplied: "+a.points.toLocaleString()),teamTableUserCell.innerHTML=a[b].toLocaleString(),new bootstrap.Tooltip(teamTableUserCell)):
"displayName"===b?(teamTableUserCell.innerHTML=a[b],a[b]===e&&(teamTableUserCell.innerHTML+=" (Captain)"),"profileLink"in a&&(teamTableUserCell.innerHTML="\x3ca href\x3d'"+a.profileLink+"' target\x3d'_blank'\x3e"+teamTableUserCell.innerHTML+"\x3c/a\x3e"),"liveStatsLink"in a&&(teamTableUserCell.innerHTML+=" \x3ca href\x3d'"+a.liveStatsLink+"' target\x3d'_blank'\x3e\x3cimg alt\x3d'stats' src\x3d'./res/img/live.png' width\x3d'16px' height\x3d'16px'\x3e\x3c/a\x3e"),a.displayName!=a.foldingName&&(teamTableUserCell.setAttribute("data-bs-toggle",
"tooltip"),teamTableUserCell.setAttribute("data-placement","left"),teamTableUserCell.setAttribute("title","Folding Username: "+a.foldingName),new bootstrap.Tooltip(teamTableUserCell))):"hardware"===b?(teamTableUserCell.setAttribute("data-bs-toggle","tooltip"),teamTableUserCell.setAttribute("data-placement","left"),teamTableUserCell.setAttribute("title","Multiplier: x"+a.hardware.multiplier.toLocaleString()),teamTableUserCell.innerHTML=a[b].displayName.toLocaleString(),new bootstrap.Tooltip(teamTableUserCell)):
teamTableUserCell.innerHTML=a[b].toLocaleString();teamTableBodyRow.append(teamTableUserCell)});teamTableBody.append(teamTableBodyRow)});retiredUsers=a.retiredUsers;retiredUsers.sort(sortJsonByKey("rankInTeam"));retiredUsers.forEach(function(a,b){teamTableBodyRow=document.createElement("tr");c.forEach(function(b,c){teamTableUserCell=document.createElement("td");"multipliedPoints"===b?(teamTableUserCell.setAttribute("data-bs-toggle","tooltip"),teamTableUserCell.setAttribute("data-placement","left"),
teamTableUserCell.setAttribute("title","Unmultiplied: "+a.points.toLocaleString()),teamTableUserCell.innerHTML=a[b].toLocaleString(),new bootstrap.Tooltip(teamTableUserCell)):"userName"===b?teamTableUserCell.innerHTML=a[b]+" (retired)":"hardware"===b?(teamTableUserCell.setAttribute("data-bs-toggle","tooltip"),teamTableUserCell.setAttribute("data-placement","left"),teamTableUserCell.setAttribute("title","Multiplier: x"+a.hardware.multiplier.toLocaleString()),teamTableUserCell.innerHTML=a[b].displayName.toLocaleString(),
new bootstrap.Tooltip(teamTableUserCell)):teamTableUserCell.innerHTML=a[b].toLocaleString();teamTableBodyRow.append(teamTableUserRow)});teamTableBody.append(teamTableBodyRow)});teamTable.append(teamTableBody);subDiv.append(teamTable);teamDiv.append(subDiv);statsDiv=document.getElementById("stats_div");statsDiv.append(teamDiv);statsDiv.append(document.createElement("br"))})})}
document.addEventListener("DOMContentLoaded",function(a){loadOverallStats();loadTeamLeaderboard();loadCategoryLeaderboard();loadTeamStats();startTimer()});function show(a){document.getElementById(a).style.display="block"}function hide(a){document.getElementById(a).style.display="none"}window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date);gtag("config","G-NTH3EFBH2T");function sortJsonByKey(a){return function(b,c){return b[a]>c[a]?1:b[a]<c[a]?-1:0}}
function isStorageAvailable(a){var b;try{return b=window[a],b.setItem("__storage_test__","__storage_test__"),b.removeItem("__storage_test__"),!0}catch(c){return c instanceof DOMException&&(22===c.code||1014===c.code||"QuotaExceededError"===c.name||"NS_ERROR_DOM_QUOTA_REACHED"===c.name)&&b&&0!==b.length}}function storageGet(a){return localStorage.getItem(a)}function storageSet(a,b){localStorage.setItem(a,b)}function storageContains(a){return null!==localStorage.getItem(a)}
function sortTable(a,b){var c,e,f,d,g,h,k,l=0;b=document.getElementById(b);e=!0;for(k="asc";e;){e=!1;c=b.rows;for(f=1;f<c.length-1;f++)if(h=!1,d=c[f].getElementsByTagName("TD")[a],g=c[f+1].getElementsByTagName("TD")[a],"asc"==k)if(isNaN(d.innerHTML)||isNaN(g.innerHTML)){if(d.innerHTML.toLowerCase()>g.innerHTML.toLowerCase()){h=!0;break}}else{if(parseInt(d.innerHTML)>parseInt(g.innerHTML)){h=!0;break}}else if("desc"==k)if(isNaN(d.innerHTML)||isNaN(g.innerHTML)){if(d.innerHTML.toLowerCase()<g.innerHTML.toLowerCase()){h=
!0;break}}else if(parseInt(d.innerHTML)<parseInt(g.innerHTML)){h=!0;break}h?(c[f].parentNode.insertBefore(c[f+1],c[f]),e=!0,l++):0==l&&"asc"==k&&(k="desc",e=!0)}}var NUMBER_OF_UPDATES_PROPERTY_NAME="numberOfUpdates",UPDATE_MINUTE=55;function startTimer(){calculateNumberOfUpdates();updateTimer()}
function calculateNumberOfUpdates(){if(isStorageAvailable){var a=new Date,b=Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),1,0,UPDATE_MINUTE,0,0);seconds=Math.floor((a-b)/1E3);minutes=seconds/60;hours=Math.floor(minutes/60);storageContains(NUMBER_OF_UPDATES_PROPERTY_NAME)&&(a=storageGet(NUMBER_OF_UPDATES_PROPERTY_NAME),a<hours&&(a=hours-a,document.getElementById("toast-update-count-text").innerHTML=1==a?a.toLocaleString()+" update":a.toLocaleString()+" updates",showToast("toast-update",!0)));storageSet(NUMBER_OF_UPDATES_PROPERTY_NAME,
hours)}else console.log("No local storage available!")}function updateTimer(){var a=new Date,a=3600-(a.getUTCMinutes()-UPDATE_MINUTE)%60*60-a.getUTCSeconds();minutes=Math.floor(a/60)%60;seconds=a%60;document.getElementById("min-part").innerHTML=minutes;document.getElementById("sec-part").innerHTML=String(seconds).padStart(2,"0");0===minutes&&0===seconds&&showToast("toast-refresh",!1);setTimeout(updateTimer,1E3-(new Date).getUTCMilliseconds())}
function showToast(a,b){(new bootstrap.Toast(document.getElementById(a),{animation:!0,autohide:b,delay:3E3})).show()}function closeToast(a){(new bootstrap.Toast(document.getElementById(a))).dispose()};
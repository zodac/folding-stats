var ROOT_URL="http://internal.axihub.ca/folding";
function populateDropdown(){for(var a=document.getElementById("user_dropdown");a.firstChild;)a.removeChild(a.lastChild);fetch(ROOT_URL+"/users").then(function(a){return a.json()}).then(function(a){dropdown_div=document.getElementById("user_dropdown");a.forEach(function(a,g){userButton=document.createElement("button");userButton.setAttribute("class","dropdown-item");userButton.setAttribute("type","button");userButton.setAttribute("onclick","getUserHistoricStats("+a.id+",'"+a.displayName+"')");userButton.innerHTML=
a.displayName;dropdown_div.append(userButton)})})}
function getUserHistoricStats(a,f){show("loader");hide("historic_stats");var b=(new Date).getFullYear();fetch(ROOT_URL+"/historic/users/"+a+"/"+b).then(function(a){return a.json()}).then(function(a){dropDownTitle=document.getElementById("user_dropdown_root");dropDownTitle.innerHTML=f;for(historicDiv=document.getElementById("historic_stats");historicDiv.firstChild;)historicDiv.removeChild(historicDiv.lastChild);userTitle=document.createElement("h1");userTitle.setAttribute("class","navbar-brand");userTitle.innerHTML=
f+" ("+b+")";historicDiv.append(userTitle);historicTable=document.createElement("table");historicTable.setAttribute("id","historic_table");historicTable.setAttribute("class","table table-dark table-striped table-hover");tableHead=document.createElement("thead");tableHeaderRow=document.createElement("tr");["Month","Points","Units"].forEach(function(a,b){tableHeader=document.createElement("th");tableHeader.setAttribute("onclick","sortTable("+b+", 'historic_table')");tableHeader.setAttribute("scope",
"col");tableHeader.innerHTML=a;tableHeaderRow.append(tableHeader)});tableHead.append(tableHeaderRow);historicTable.append(tableHead);tableBody=document.createElement("tbody");a.forEach(function(a,d){tableRow=document.createElement("tr");dateCell=document.createElement("td");dateCell.innerHTML=(new Date(b,a.monthNumber-1,"01")).toLocaleString("default",{month:"long"});tableRow.append(dateCell);pointsCell=document.createElement("td");pointsCell.setAttribute("data-bs-toggle","tooltip");pointsCell.setAttribute("data-placement",
"top");pointsCell.setAttribute("title","Unmultiplied: "+a.points.toLocaleString());pointsCell.innerHTML=a.multipliedPoints.toLocaleString();new bootstrap.Tooltip(pointsCell);tableRow.append(pointsCell);unitsCell=document.createElement("td");unitsCell.innerHTML=a.units.toLocaleString();tableRow.append(unitsCell);tableBody.append(tableRow)});historicTable.append(tableBody);historicDiv.append(historicTable);hide("loader");show("historic_stats")})}
document.addEventListener("DOMContentLoaded",function(a){populateDropdown();updateTimer()});function show(a){document.getElementById(a).style.display="block"}function hide(a){document.getElementById(a).style.display="none"}
function sortTable(a,f){var b,g,c,d,e,h,k,l=0;f=document.getElementById(f);g=!0;for(k="asc";g;){g=!1;b=f.rows;for(c=1;c<b.length-1;c++)if(h=!1,d=b[c].getElementsByTagName("TD")[a],e=b[c+1].getElementsByTagName("TD")[a],"asc"==k)if(isNaN(d.innerHTML)||isNaN(e.innerHTML)){if(d.innerHTML.toLowerCase()>e.innerHTML.toLowerCase()){h=!0;break}}else{if(parseInt(d.innerHTML)>parseInt(e.innerHTML)){h=!0;break}}else if("desc"==k)if(isNaN(d.innerHTML)||isNaN(e.innerHTML)){if(d.innerHTML.toLowerCase()<e.innerHTML.toLowerCase()){h=
!0;break}}else if(parseInt(d.innerHTML)<parseInt(e.innerHTML)){h=!0;break}h?(b[c].parentNode.insertBefore(b[c+1],b[c]),g=!0,l++):0==l&&"asc"==k&&(k="desc",g=!0)}}function updateTimer(){var a=new Date,a=3600-(a.getUTCMinutes()-15)%60*60-a.getUTCSeconds();minutes=Math.floor(a/60)%60;seconds=a%60;document.getElementById("min-part").innerHTML=minutes;document.getElementById("sec-part").innerHTML=String(seconds).padStart(2,"0");setTimeout(updateTimer,1E3-(new Date).getUTCMilliseconds())};
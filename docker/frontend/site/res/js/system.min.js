var ROOT_URL="http://internal.axihub.ca/folding";function toggleMainButtonStyle(a,b){a=document.getElementById(a+"_button");b.contains("collapsed")?(a.classList.add("btn-primary"),a.classList.remove("btn-success")):(a.classList.add("btn-success"),a.classList.remove("btn-primary"))}
function adminLogin(){var a=document.getElementById("inputUserName").value,b=document.getElementById("inputPassword").value,c="Basic "+encode(a,b),a={encodedUserNameAndPassword:c};show("loader");fetch(ROOT_URL+"/login/admin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(function(a){document.getElementById("inputUserName").value="";document.getElementById("inputPassword").value="";hide("loader");200!=a.status?showToast("toast-login-failure",!0):(showToast("toast-login-success",
!0),hide("login-form"),show("admin-functions"),sessionSet("Authorization",c))})}
function loadHardware(){fetch(ROOT_URL+"/hardware").then(function(a){return a.json()}).then(function(a){a.sort(sortJsonByKey("id"));var b=["id","displayName","operatingSystem","multiplier"];hardwareDiv=document.getElementById("hardware_div");hardwareTitle=document.createElement("h2");hardwareTitle.setAttribute("class","navbar-brand");hardwareTitle.innerHTML="Hardware";hardwareDiv.append(hardwareTitle);hardwareTable=document.createElement("table");hardwareTable.setAttribute("id","hardware");hardwareTable.setAttribute("class",
"table table-dark table-striped table-hover");hardwareTableHead=document.createElement("thead");hardwareTableHeaderRow=document.createElement("tr");["ID","Name","Operating System","Multiplier"].forEach(function(a,b){hardwareTableHeader=document.createElement("th");hardwareTableHeader.setAttribute("onclick","sortTable("+b+", 'hardware')");hardwareTableHeader.setAttribute("scope","col");hardwareTableHeader.innerHTML=a;hardwareTableHeaderRow.append(hardwareTableHeader)});hardwareTableHead.append(hardwareTableHeaderRow);
hardwareTable.append(hardwareTableHead);hardwareTableBody=document.createElement("tbody");dataListOfHardware=document.getElementById("available-hardware");a.forEach(function(a,d){hardwareTableBodyRow=document.createElement("tr");b.forEach(function(c,b){hardwareTableBodyCell=document.createElement("td");hardwareTableBodyCell.innerHTML="multiplier"===c?"x"+a[c].toLocaleString():a[c].toLocaleString();hardwareTableBodyRow.append(hardwareTableBodyCell)});hardwareTableBody.append(hardwareTableBodyRow);
hardwareOption=document.createElement("option");hardwareOption.setAttribute("value",a.id);hardwareOption.innerHTML=a.displayName;dataListOfHardware.append(hardwareOption)});hardwareTable.append(hardwareTableBody);hardwareDiv.append(hardwareTable)})}
function loadUsers(){fetch(ROOT_URL+"/users").then(function(a){return a.json()}).then(function(a){a.sort(sortJsonByKey("id"));var b="id displayName foldingUserName passkey category hardwareId profileLink liveStatsLink isRetired".split(" ");usersDiv=document.getElementById("users_div");usersTitle=document.createElement("h2");usersTitle.setAttribute("class","navbar-brand");usersTitle.innerHTML="Users";usersDiv.append(usersTitle);usersTable=document.createElement("table");usersTable.setAttribute("id",
"users");usersTable.setAttribute("class","table table-dark table-striped table-hover");usersTableHead=document.createElement("thead");usersTableHeaderRow=document.createElement("tr");"ID;User;Folding Name;Passkey;Category;Hardware ID;Profile Link;Live Stats Link;Retired".split(";").forEach(function(a,b){usersTableHeader=document.createElement("th");usersTableHeader.setAttribute("onclick","sortTable("+b+", 'users')");usersTableHeader.setAttribute("scope","col");usersTableHeader.innerHTML=a;usersTableHeaderRow.append(usersTableHeader)});
usersTableHead.append(usersTableHeaderRow);usersTable.append(usersTableHead);usersTableBody=document.createElement("tbody");dataListOfUsers=document.getElementById("available-users");selectOfUsers=document.getElementById("create-team-users");a.forEach(function(a,d){usersTableBodyRow=document.createElement("tr");b.forEach(function(b,c){usersTableBodyCell=document.createElement("td");"liveStatsLink"===b||"profileLink"===b?b in a&&(link=document.createElement("a"),link.setAttribute("href",a[b]),link.innerHTML=
a[b],usersTableBodyCell.append(link)):b in a&&(usersTableBodyCell.innerHTML=a[b].toLocaleString());usersTableBodyRow.append(usersTableBodyCell)});usersTableBody.append(usersTableBodyRow);userOption=document.createElement("option");userOption.setAttribute("value",a.id);userOption.innerHTML=a.displayName;dataListOfUsers.append(userOption);selectOfUsers.append(userOption)});usersTable.append(usersTableBody);usersDiv.append(usersTable)})}
function loadTeams(){fetch(ROOT_URL+"/teams").then(function(a){return a.json()}).then(function(a){a.sort(sortJsonByKey("id"));var b="id teamName teamDescription forumLink captainUserId userIds retiredUserIds".split(" ");teamsDiv=document.getElementById("teams_div");teamsTitle=document.createElement("h2");teamsTitle.setAttribute("class","navbar-brand");teamsTitle.innerHTML="Teams";teamsDiv.append(teamsTitle);teamsTable=document.createElement("table");teamsTable.setAttribute("id","teams");teamsTable.setAttribute("class",
"table table-dark table-striped table-hover");teamsTableHead=document.createElement("thead");teamsTableHeaderRow=document.createElement("tr");"ID;Name;Description;Forum Link;Captain ID;User IDs;Retired User IDs".split(";").forEach(function(a,b){teamsTableHeader=document.createElement("th");teamsTableHeader.setAttribute("onclick","sortTable("+b+", 'teams')");teamsTableHeader.setAttribute("scope","col");teamsTableHeader.innerHTML=a;teamsTableHeaderRow.append(teamsTableHeader)});teamsTableHead.append(teamsTableHeaderRow);
teamsTable.append(teamsTableHead);teamsTableBody=document.createElement("tbody");a.forEach(function(a,d){teamsTableBodyRow=document.createElement("tr");b.forEach(function(b,c){teamsTableBodyCell=document.createElement("td");"forumLink"===b?b in a&&(link=document.createElement("a"),link.setAttribute("href",a[b]),link.setAttribute("target","_blank"),link.innerHTML=a[b],teamsTableBodyCell.append(link)):b in a&&(teamsTableBodyCell.innerHTML=a[b].toLocaleString());teamsTableBodyRow.append(teamsTableBodyCell)});
teamsTableBody.append(teamsTableBodyRow)});teamsTable.append(teamsTableBody);teamsDiv.append(teamsTable)})}document.addEventListener("DOMContentLoaded",function(a){sessionContains("Authorization")&&(hide("login-form"),show("admin-functions"));loadHardware();loadUsers();loadTeams();updateTimer();hide("loader")});function show(a){document.getElementById(a).style.display="block"}function hide(a){document.getElementById(a).style.display="none"}function encode(a,b){return btoa(a+":"+b)}
function sortJsonByKey(a){return function(b,c){return b[a]>c[a]?1:b[a]<c[a]?-1:0}}function localGet(a){return localStorage.getItem(a)}function localSet(a,b){localStorage.setItem(a,b)}function localContains(a){return null!==localGet(a)}function sessionGet(a){return sessionStorage.getItem(a)}function sessionSet(a,b){sessionStorage.setItem(a,b)}function sessionContains(a){return null!==sessionGet(a)}
function sortTable(a,b){var c,d,e,f,g,h,k,l=0;b=document.getElementById(b);d=!0;for(k="asc";d;){d=!1;c=b.rows;for(e=1;e<c.length-1;e++)if(h=!1,f=c[e].getElementsByTagName("TD")[a],g=c[e+1].getElementsByTagName("TD")[a],"asc"==k)if(isNaN(f.innerHTML)||isNaN(g.innerHTML)){if(f.innerHTML.toLowerCase()>g.innerHTML.toLowerCase()){h=!0;break}}else{if(parseInt(f.innerHTML)>parseInt(g.innerHTML)){h=!0;break}}else if("desc"==k)if(isNaN(f.innerHTML)||isNaN(g.innerHTML)){if(f.innerHTML.toLowerCase()<g.innerHTML.toLowerCase()){h=
!0;break}}else if(parseInt(f.innerHTML)<parseInt(g.innerHTML)){h=!0;break}h?(c[e].parentNode.insertBefore(c[e+1],c[e]),d=!0,l++):0==l&&"asc"==k&&(k="desc",d=!0)}}var NUMBER_OF_UPDATES_PROPERTY_NAME="numberOfUpdates",UPDATE_MINUTE=55;function startTimer(){calculateNumberOfUpdates();updateTimer()}
function calculateNumberOfUpdates(){var a=new Date,b=Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),1,0,UPDATE_MINUTE,0,0);seconds=Math.floor((a-b)/1E3);minutes=seconds/60;hours=Math.floor(minutes/60);localContains(NUMBER_OF_UPDATES_PROPERTY_NAME)&&(a=localGet(NUMBER_OF_UPDATES_PROPERTY_NAME),a<hours&&(a=hours-a,document.getElementById("toast-update-count-text").innerHTML=1==a?a.toLocaleString()+" update":a.toLocaleString()+" updates",showToast("toast-update",!0)));localSet(NUMBER_OF_UPDATES_PROPERTY_NAME,
hours)}function updateTimer(){var a=new Date,a=3600-(a.getUTCMinutes()-UPDATE_MINUTE)%60*60-a.getUTCSeconds();minutes=Math.floor(a/60)%60;seconds=a%60;document.getElementById("min-part").innerHTML=minutes;document.getElementById("sec-part").innerHTML=String(seconds).padStart(2,"0");0===minutes&&0===seconds&&showToast("toast-refresh",!1);setTimeout(updateTimer,1E3-(new Date).getUTCMilliseconds())}
function showToast(a,b){(new bootstrap.Toast(document.getElementById(a),{animation:!0,autohide:b,delay:3E3})).show()}function closeToast(a){(new bootstrap.Toast(document.getElementById(a))).dispose()};